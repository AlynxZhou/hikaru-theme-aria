{#
  Put macros here. This file should be imported with context to use helpers from
  Hikaru in context.
#}

{#
  Only use macros when necessary, for example you need to do recursion, or you
  have the same pieces of code in different places that generates inline
  elements. Don't use macros to generate large HTML skeletons.
#}

{#
  This is used to generate description used in meta tags, auto excerpt of posts
  in home page is different from this.
#}
{%- macro generateMetaDescription(file) -%}
{%- if file.excerpt  %}
{{- file.excerpt | striptags }}
{%- elseif file.description %}
{{- file.description | striptags }}
{%- elseif file.content and themeConfig.autoExcerpt %}
{{- (file.content | striptags).substring(0, themeConfig.autoExcerpt) }}â€¦
{%- elseif siteConfig.subtitle %}
{{- siteConfig.subtitle }}
{%- elseif siteConfig.description %}
{{- siteConfig.description }}
{%- endif %}
{%- endmacro -%}

{%- macro listCategory(cates) -%}
{%- if cates and cates.length > 0 %}
<ul>
  {%- for cate in cates %}
  <li>
    <a href="{{ getPath(cate.docPath) }}">{{ cate.name }}</a>{% if cate.posts and cate.posts.length > 0 %} <span>{{ cate.posts.length }}</span>{% endif %}
    {{- listCategory(cate.subs) }}
  </li>
  {%- endfor %}
</ul>
{%- endif %}
{%- endmacro -%}

{%- macro listTOC(toc, level = 1) -%}
{%- if toc and toc.length > 0 %}
<ol{% if level === 1 %} class="toc" id="scrollspy-target"{% endif %}>
  {%- for h in toc %}
  <li>
    {#-
      Don't set anchor to absolute path, because it's hard to write selector for
      scrollspy.
    #}
    <a class="list-group-item toc-link" href="{{ h.archor }}">{{ h.text }}</a>
    {{- listTOC(h.subs, level + 1) }}
  </li>
  {%- endfor %}
</ol>
{%- endif %}
{%- endmacro -%}

{%- macro formatDateTime(dt) -%}
{%- set year = dt.getFullYear() %}
{%- set month = dt.getMonth() + 1 %}
{%- if month <= 9 %}
{%- set month = ["0", month].join("") %}
{%- endif %}
{%- set date = dt.getDate() %}
{%- if date <= 9 %}
{%- set date = ["0", date].join("") %}
{%- endif %}
{%- set hour = dt.getHours() %}
{%- if hour <= 9 %}
{%- set hour = ["0", hour].join("") %}
{%- endif %}
{%- set minute = dt.getMinutes() %}
{%- if minute <= 9 %}
{%- set minute = ["0", minute].join("") %}
{%- endif %}
{%- set second = dt.getSeconds() %}
{%- if second <= 9 %}
{%- set second = ["0", second].join("") %}
{%- endif %}
{#- This is a inline macro so we strip start to prevent line break. #}
{{- year }}-{{ month }}-{{ date }} {{ hour }}:{{ minute }}:{{ second }}
{%- endmacro -%}
